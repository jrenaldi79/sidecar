/**
 * Sidecar CSS Injection
 *
 * Spec Reference:
 * - 9.2 Electron Shell
 * - 14.3 Styling Investigation
 *
 * This CSS is injected into the OpenCode web UI to:
 * 1. Apply dark theme matching Claude Code Desktop
 * 2. Hide unnecessary UI elements (sidebar, nav)
 * 3. Make room for custom title bar and FOLD button
 *
 * Theme values extracted from Claude Desktop app.asar (2025-01-25)
 * Source: /Applications/Claude.app/Contents/Resources/app.asar
 */

/* ============================================================================
 * CSS Variables - Design Tokens (Extracted from Claude Desktop)
 * ============================================================================
 * These values match Claude Desktop's dark theme (.darkTheme class)
 * Source: window-shared.css in Claude Desktop app bundle
 */
:root {
  /* Background colors - Claude Desktop dark theme */
  --sidecar-bg-primary: #262624;      /* bg-000 in dark theme */
  --sidecar-bg-secondary: #252523;    /* bg-100 in dark theme (60 2.7% 14.5%) */
  --sidecar-bg-tertiary: #1f1e1d;     /* bg-200 in dark theme (30 3.3% 11.8%) */
  --sidecar-bg-deep: #141413;         /* bg-300 in dark theme (60 2.6% 7.6%) */

  /* Text colors - Claude Desktop dark theme */
  --sidecar-text-primary: #f5f4ef;    /* text-100 in dark theme */
  --sidecar-text-secondary: #e5e5e2;  /* text-200 in dark theme */
  --sidecar-text-muted: #b8b5a9;      /* text-400 in dark theme */
  --sidecar-text-description: #ceccc5; /* description-text in dark theme */

  /* Accent colors - Claude brand */
  --sidecar-accent: #d97757;          /* Claude clay orange (brand color) */
  --sidecar-accent-hover: #c9674a;    /* Slightly darker for hover */

  /* FOLD button colors - success green */
  --sidecar-fold-bg: #4a9137;         /* success-100 in dark theme */
  --sidecar-fold-hover: #5aaf44;      /* Lighter for hover */

  /* Border colors - Claude Desktop dark theme */
  --sidecar-border: rgba(108, 106, 96, 0.25);      /* border-300 approx */
  --sidecar-border-strong: rgba(108, 106, 96, 0.58); /* border-300-more */

  /* Secondary colors */
  --sidecar-secondary: #a6a39a;       /* secondary color in dark theme */

  /* Spacing */
  --sidecar-title-height: 28px;
  --sidecar-padding: 12px;

  /* Typography - Claude Desktop system font stack */
  --sidecar-font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", "Roboto", "Oxygen", "Ubuntu", "Cantarell", "Fira Sans", "Droid Sans", "Helvetica Neue", sans-serif;
  --sidecar-font-mono: ui-monospace, SFMono-Regular, "SF Mono", Menlo, Consolas, "Liberation Mono", monospace;
  --sidecar-font-size-sm: 11px;
  --sidecar-font-size-base: 13px;
  --sidecar-font-size-lg: 15px;

  /* Border radius */
  --sidecar-radius-sm: 4px;
  --sidecar-radius-md: 6px;
  --sidecar-radius-lg: 8px;
}

/* ============================================================================
 * Hide Sidebar/Nav Elements
 * ============================================================================
 * Spec Reference: 9.2 - "Hide sidebar/nav elements"
 *
 * OpenCode may have various navigation elements that we hide to maximize
 * the conversation area and simplify the UI for sidecar use.
 */
aside,
header:not(.sidecar-title),
nav,
footer,
[role="navigation"],
[data-sidebar],
[data-nav],
.sidebar,
.navigation,
.nav-panel,
.header-bar,
.footer-bar {
  display: none !important;
}

/* ============================================================================
 * Main Content Adjustment
 * ============================================================================
 * Make room for the custom title bar at the top.
 */
body {
  background: var(--sidecar-bg-primary) !important;
  padding-top: 32px !important;
  margin: 0 !important;
  font-family: var(--sidecar-font-family) !important;
}

main,
[role="main"],
.main-content {
  padding-top: var(--sidecar-padding) !important;
  background: var(--sidecar-bg-primary) !important;
  min-height: calc(100vh - 32px) !important;
}

/* ============================================================================
 * Dark Theme Overrides
 * ============================================================================
 * Override OpenCode's default colors to match Claude Code Desktop.
 */

/* General containers */
div[class*="container"],
div[class*="wrapper"],
section {
  background-color: var(--sidecar-bg-primary) !important;
}

/* Message bubbles */
[data-role="user"],
.user-message,
[class*="user-message"] {
  background: var(--sidecar-bg-tertiary) !important;
  color: var(--sidecar-text-primary) !important;
  border-radius: var(--sidecar-radius-md) !important;
}

[data-role="assistant"],
.assistant-message,
[class*="assistant-message"] {
  background: var(--sidecar-bg-secondary) !important;
  color: var(--sidecar-text-primary) !important;
  border-radius: var(--sidecar-radius-md) !important;
}

/* Input area */
textarea,
input[type="text"],
.chat-input,
[class*="input"] {
  background: var(--sidecar-bg-secondary) !important;
  color: var(--sidecar-text-primary) !important;
  border: 1px solid var(--sidecar-border) !important;
  border-radius: var(--sidecar-radius-md) !important;
}

textarea:focus,
input[type="text"]:focus {
  border-color: var(--sidecar-border-light) !important;
  outline: none !important;
}

/* Buttons */
button:not(#fold-btn) {
  background: var(--sidecar-bg-secondary) !important;
  color: var(--sidecar-text-primary) !important;
  border: 1px solid var(--sidecar-border) !important;
  border-radius: var(--sidecar-radius-sm) !important;
}

button:not(#fold-btn):hover {
  background: var(--sidecar-bg-tertiary) !important;
  border-color: var(--sidecar-border-light) !important;
}

/* Submit/send button */
button[type="submit"],
.send-button,
[class*="send"] {
  background: var(--sidecar-accent) !important;
  border-color: var(--sidecar-accent) !important;
}

button[type="submit"]:hover,
.send-button:hover {
  background: var(--sidecar-accent-hover) !important;
}

/* Code blocks */
pre,
code,
[class*="code"] {
  background: #1e1e1e !important;
  color: #d4d4d4 !important;
  border-radius: var(--sidecar-radius-sm) !important;
  font-family: "SF Mono", Monaco, Consolas, "Liberation Mono", "Courier New", monospace !important;
}

/* Links */
a {
  color: var(--sidecar-accent) !important;
}

a:hover {
  color: var(--sidecar-accent-hover) !important;
}

/* Scrollbar styling */
::-webkit-scrollbar {
  width: 8px;
  height: 8px;
}

::-webkit-scrollbar-track {
  background: var(--sidecar-bg-primary);
}

::-webkit-scrollbar-thumb {
  background: var(--sidecar-border);
  border-radius: 4px;
}

::-webkit-scrollbar-thumb:hover {
  background: var(--sidecar-border-light);
}

/* ============================================================================
 * Resume Notice Styling
 * ============================================================================
 * When resuming a session, a notice is shown at the top.
 */
#resume-notice {
  background: var(--sidecar-bg-tertiary) !important;
  color: var(--sidecar-text-secondary) !important;
  font-size: var(--sidecar-font-size-sm) !important;
  border-bottom: 1px solid var(--sidecar-border) !important;
}

/* ============================================================================
 * Loading States
 * ============================================================================
 */
.loading,
.spinner,
[class*="loading"],
[class*="spinner"] {
  color: var(--sidecar-text-secondary) !important;
}

/* ============================================================================
 * Error States
 * ============================================================================
 */
.error,
[class*="error"] {
  color: #ef4444 !important;
  background: rgba(239, 68, 68, 0.1) !important;
  border-color: rgba(239, 68, 68, 0.3) !important;
}

/* ============================================================================
 * Animations
 * ============================================================================
 * Subtle animations for a polished feel.
 */
button,
input,
textarea,
a {
  transition: background-color 0.15s ease, border-color 0.15s ease, color 0.15s ease;
}

/* ============================================================================
 * Model Selector
 * ============================================================================
 * Styles for the model dropdown and display.
 */
#model-selector {
  position: relative;
  display: inline-block;
}

#model-selector-display {
  background: var(--sidecar-bg-secondary);
  border: 1px solid var(--sidecar-border);
  color: var(--sidecar-text-secondary);
  padding: 4px 8px;
  border-radius: var(--sidecar-radius-md);
  cursor: pointer;
  display: flex;
  align-items: center;
  gap: 6px;
  font-size: var(--sidecar-font-size-sm);
  transition: background-color 0.15s ease, border-color 0.15s ease;
}

#model-selector-display:hover {
  background: var(--sidecar-bg-tertiary);
  border-color: var(--sidecar-border-light);
}

#model-selector-dropdown {
  display: none;
  position: absolute;
  bottom: 100%;
  left: 0;
  margin-bottom: 4px;
  background: var(--sidecar-bg-deep);
  border: 1px solid var(--sidecar-border-strong);
  border-radius: var(--sidecar-radius-md);
  padding: 4px;
  z-index: 100;
  min-width: 250px;
  max-height: 300px;
  overflow-y: auto;
  box-shadow: 0 4px 12px rgba(0,0,0,0.3);
}

#model-selector-dropdown.visible {
  display: block;
}

.model-option {
  padding: 6px 10px;
  cursor: pointer;
  border-radius: var(--sidecar-radius-sm);
  display: flex;
  justify-content: space-between;
  align-items: center;
  font-size: var(--sidecar-font-size-base);
}

.model-option:hover {
  background: var(--sidecar-bg-tertiary);
}

.model-option.selected {
  background: var(--sidecar-accent);
  color: #fff;
}

.model-name-display {
  font-weight: 500;
}

.model-context-size {
  font-size: var(--sidecar-font-size-sm);
  color: var(--sidecar-text-muted);
  background: var(--sidecar-bg-secondary);
  padding: 2px 5px;
  border-radius: var(--sidecar-radius-sm);
}

.model-option.selected .model-context-size {
  color: #fff;
  background: rgba(0,0,0,0.2);
}

/* ============================================================================
 * Print Styles (hidden)
 * ============================================================================
 * Hide UI elements when printing, if needed.
 */
@media print {
  body::before,
  #fold-btn,
  #resume-notice {
    display: none !important;
  }

  body {
    padding-top: 0 !important;
  }
}
